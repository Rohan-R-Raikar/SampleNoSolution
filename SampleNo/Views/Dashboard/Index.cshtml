@using Azure.Core
@model SampleNo.Models.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Welcome to Your Dashboard</h2>
    <a href="@Url.Action("Index", "Profile")" class="btn btn-outline-primary">My Profile</a>
</div>


<form asp-action="Index" method="get" class="mb-4">
    <input type="text" name="searchTerm" placeholder="Search users..."
           class="form-control w-50 d-inline"
           value="@Context.Request.Query["searchTerm"]" />
    <button type="submit" class="btn btn-primary ml-2">Search</button>
</form>



@if (Model.SearchedUsers != null && Model.SearchedUsers.Any())
{
    <h4>Search Results</h4>
    <ul class="list-group mb-4">
        @foreach (var user in Model.SearchedUsers)
        {
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>@user.Email</span>
                <form asp-action="ToggleFollow" method="post" class="m-0">
                    <input type="hidden" name="targetUserId" value="@user.UserId" />
                    <button type="submit" class="btn btn-sm @(user.IsFollowing ? "btn-danger" : "btn-success")">
                        @(user.IsFollowing ? "Unfollow" : "Follow")
                    </button>
                </form>
            </li>
        }
    </ul>
}

@if (Model.FollowedUserStory != null && Model.FollowedUserStory.Any())
{
    <h4>Stories</h4>
    <div class="row">
        @foreach (var story in Model.FollowedUserStory)
        {
            <div class="col-md-3">
                <div class="card mb-2">
                    <div class="card-body">
                        <h5>@story.StoryTitle</h5>
                        <p>@story.StoryBody</p>
                        <p>@story.ExpiresAt</p>
                        <p>@story.Status</p>
                        <form asp-action="ToggleLike" method="post" class="d-inline">
    <input type="hidden" name="targetId" value="@story.StoryId" />
    <input type="hidden" name="targetType" value="Story" />
    <button type="submit" class="btn btn-link p-0 border-0">
        @if (story.IsLikedByCurrentUser)
        {
            <span style="color:red;">&#10084;</span> <!-- Solid Heart -->
        }
        else
        {
            <span style="color:gray;">&#9825;</span> <!-- Outline Heart -->
        }
    </button>
    <span>@story.LikeCount</span>
</form>

                    </div>
                </div>
            </div>
        }
    </div>
}
@if (Model.FollowedUserPost != null && Model.FollowedUserPost.Any())
{
    <h4>Posts</h4>
    <div class="row">
        @foreach (var post in Model.FollowedUserPost)
        {
            <div class="col-md-6">
                <div class="card mb-3">
                    <div class="card-body">
                        <h5>@post.PostTitle</h5>
                        <p>@post.PostBody</p>
                        <p>@post.Status</p>
                        <form asp-action="ToggleLike" method="post" class="d-inline">
    <input type="hidden" name="targetId" value="@post.PostId" />
    <input type="hidden" name="targetType" value="Post" />
    <button type="submit" class="btn btn-link p-0 border-0">
        @if (post.IsLikedByCurrentUser)
        {
            <span style="color:red;">&#10084;</span>
        }
        else
        {
            <span style="color:gray;">&#9825;</span>
        }
    </button>
    <span>@post.LikeCount</span>
</form>

                        @if (post.IsCommentEnabled)
                        {
                            <div><strong>Comments:</strong> @post.Comment</div>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
}
